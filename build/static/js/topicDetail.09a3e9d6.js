(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{245:function(e,t,a){"use strict";a.r(t);a(227),a(232),a(101),a(231);var n,l,r,c,o,i=a(6),s=a.n(i),p=a(5),m=a.n(p),u=a(18),d=a.n(u),_=a(17),h=a.n(_),y=a(16),f=a.n(y),v=a(0),E=a.n(v),g=a(59),N=a(230),b=a.n(N),k=a(248),x={share:{desc:"\u5206\u4eab"},good:{desc:"\u7cbe\u534e"},ask:{desc:"\u95ee\u7b54"},job:{desc:"\u62db\u8058"},dev:{desc:"\u5ba2\u6237\u7aef\u6d4b\u8bd5"}},w=(a(1),a(229)),S=a.n(w),C=a(228),M=a.n(C),j=Object(g.b)(function(e){return{createReply:e.detailStore.createReply}})(n=Object(g.c)((r=l=function(e){function t(){var e,a;s()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=d()(this,(e=h()(t)).call.apply(e,[this].concat(l)))).state={content:""},a.textChange=function(e){a.setState({content:e.target.value})},a.createReply=function(){var e=a.state.content;a.props.replyId&&(e="".concat(a.props.placeholder," ").concat(e)),e+="\n    \n\n\u6765\u81ea\u2728 [react-cnode](https://github.com/MMGong/react-cnode) \u2728",a.props.createReply(e,a.props.replyId).then(function(e){e&&(a.setState({content:""}),window.scrollTo(0,document.body.scrollHeight),a.props.hideCb())})},a}return f()(t,e),m()(t,[{key:"render",value:function(){var e=this.state.content,t=this.props.placeholder;return E.a.createElement("div",{className:"reply__text clearfix"},E.a.createElement("div",{className:"reply__text--title"},"\u8bc4\u8bba"),E.a.createElement("textarea",{className:"reply__text--textarea",onChange:this.textChange,placeholder:t,value:e}),E.a.createElement("button",{className:"reply__text--btn float-right",onClick:this.createReply},"\u56de\u590d"))}}]),t}(v.Component),l.defaultProps={replyId:"",placeholder:"\u8bf4\u8bf4\u4f60\u7684\u770b\u6cd5...",hideCb:function(){}},n=r))||n)||n,D=Object(g.b)(function(e){return{upReply:e.detailStore.upReply,accessToken:e.loginStore.accessToken}})(c=Object(g.c)(c=function(e){function t(){var e,a;s()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=d()(this,(e=h()(t)).call.apply(e,[this].concat(l)))).state={replyMap:{}},a.up=function(e,t){a.props.upReply(e,t,a.props.accessToken)},a.reply=function(e){var t=a.state.replyMap;t[e]?t[e]=!1:(Object.keys(t).forEach(function(e){t[e]=!1}),t[e]=!t[e]),a.setState({replyMap:t})},a.hideReply=function(){var e=a.state.replyMap;Object.keys(e).forEach(function(t){e[t]=!1}),a.setState({replyMap:e})},a}return f()(t,e),m()(t,[{key:"render",value:function(){var e=this,t=this.props.list,a=this.state.replyMap;return E.a.createElement("section",{className:"reply"},E.a.createElement("ul",{className:"reply__list"},t.map(function(t,n){return E.a.createElement("li",{className:"flex reply__item",key:t.id},E.a.createElement(k.a,{to:"/user/".concat(t.author.loginname),className:"reply__item__left"},E.a.createElement("div",{className:"reply__item--avatar",style:{backgroundImage:"url(".concat(t.author.avatar_url,")")}})),E.a.createElement("div",{className:"reply__item__right flex-1"},E.a.createElement("div",{className:"reply__item__user"},E.a.createElement("span",null,E.a.createElement(k.a,{to:"/user/".concat(t.author.loginname),className:"reply__item__user--item middle-dot"},t.author.loginname),E.a.createElement("span",{className:"reply__item__user--item middle-dot"},n+1,"\u697c"),E.a.createElement("span",{className:"reply__item__user--item middle-dot"},S()(new Date(t.create_at),{locale:M.a}),"\u524d")),E.a.createElement("span",{className:"float-right reply__item__icon reply__item__icon--huifu",onClick:function(){return e.reply(t.id)}},E.a.createElement("i",{className:"iconfont icon-huifu reply__item__user--zan"})),E.a.createElement("span",{className:"float-right reply__item__icon ".concat(t.is_uped&&"active"),onClick:function(){return e.up(t.id,n)}},E.a.createElement("i",{className:"iconfont icon-zan reply__item__user--zan"}),E.a.createElement("span",null,t.ups.length))),E.a.createElement("div",{className:"reply__item__content",dangerouslySetInnerHTML:{__html:t.content}}),a[t.id]&&E.a.createElement(j,{replyId:t.id,placeholder:"@".concat(t.author.loginname),hideCb:e.hideReply})))})),E.a.createElement(j,null))}}]),t}(v.Component))||c)||c;a(236);a.d(t,"default",function(){return R});var R=Object(g.b)("detailStore")(o=Object(g.c)(o=function(e){function t(){var e,a;s()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=d()(this,(e=h()(t)).call.apply(e,[this].concat(l)))).state={},a.collect=function(e){a.props.detailStore.collectTopic(!e)},a}return f()(t,e),m()(t,[{key:"componentDidMount",value:function(){this.props.detailStore.getTopicDetail(this.state.id)}},{key:"componentDidUpdate",value:function(e){e.detailStore.topicDetail.content&&window.hljs.initHighlighting()}},{key:"componentWillUnmount",value:function(){this.props.detailStore.clearTopicDetail()}},{key:"render",value:function(){var e=this,t=this.props.detailStore.topicDetail;return 0===Object.keys(t).length?null:E.a.createElement("section",{className:"detail"},E.a.createElement("div",{className:"detail__author flex"},E.a.createElement(k.a,{to:"/user/".concat(t.author?t.author.loginname:"")},E.a.createElement("div",{className:"detail__author__avatar",style:{backgroundImage:t.author?"url(".concat(t.author.avatar_url,")"):""}})),E.a.createElement("div",{className:"detail__author__info flex-1 flex flex-v flex-h-between"},E.a.createElement(k.a,{to:"/user/".concat(t.author?t.author.loginname:""),className:"detail__author__info--name ellipsis"},t.author?t.author.loginname:""),E.a.createElement("div",{className:"detail__author__info--status clearfix"},E.a.createElement("span",{className:"middle-dot"},"\u53d1\u5e03\u4e8e ",b()(t.create_at,"YYYY-MM-DD HH:mm")),E.a.createElement("span",{className:"middle-dot"},"\u9605\u8bfb ",t.visit_count),E.a.createElement("span",{className:"middle-dot"},"\u6765\u81ea ",x[t.tab].desc),E.a.createElement("div",{className:"detail__collect float-right",onClick:function(){return e.collect(t.is_collect)}},t.is_collect?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf")))),E.a.createElement("h1",{className:"detail__title"},t.title),E.a.createElement("div",{className:"detail__content"},E.a.createElement("div",{className:"markdown-text",dangerouslySetInnerHTML:{__html:t.content}})),E.a.createElement(D,{list:t.replies}))}}],[{key:"getDerivedStateFromProps",value:function(e){return{id:e.match.params.id}}}]),t}(v.Component))||o)||o}}]);
//# sourceMappingURL=topicDetail.09a3e9d6.js.map